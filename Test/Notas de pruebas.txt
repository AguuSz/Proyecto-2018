
#include <Adafruit_GFX.h>
#include <Adafruit_PCD8544.h>
#include <Wire.h>         // this #include still required because the RTClib depends on it
#include "RTClib.h"
#include "DHT.h"
#define DHT11_PIN A0     // what pin we're connected to
#define DHTTYPE DHT11   // DHT 11
DHT dht(DHT11_PIN, DHTTYPE);
RTC_Millis rtc;
int contrast=50;
int Temp;
int Humi;
int umi=0;
int digits;
int digitt;
boolean light = true;
volatile boolean buttonA = false;
volatile boolean buttonB = false;
volatile boolean buttonC = false;
int StateOfbuttonA = 0;
int StateOfbuttonB = 0;
int StateOfbuttonC = 0;
int NewStateOfbuttonA = 0;
int NewStateOfbuttonB = 0;
int NewStateOfbuttonC = 0;
int yearr = 2017;
int dayy = 1;
int monthh = 1;
int hourr = 0;
int minutee = 0;
int secondd = 0;
Adafruit_PCD8544 display = Adafruit_PCD8544(7, 6, 5, 4, 3);


void setup() {
  pinMode(11, INPUT_PULLUP);
  pinMode(10, INPUT_PULLUP);
  pinMode(9, INPUT_PULLUP);
  pinMode(8,OUTPUT);
  digitalWrite(8,LOW); //Turn Backlight ON
  dht.begin();
  display.begin();
  display.setContrast(contrast); //Set contrast to 50
  display.clearDisplay();
  display.display();
  rtc.begin(DateTime(F(__DATE__), F(__TIME__)));
}

void loop() {
  NewStateOfbuttonA = digitalRead(9);
  NewStateOfbuttonB = digitalRead(10);
  NewStateOfbuttonC =   digitalRead(11);
  buttonAisPressed();
  buttonBisPressed();
  buttonCisPressed();
   if (buttonA) {
   if (umi == 1 ) {
    buttonA = false;
    contrast++;
    setContrast();
    }
  else if (umi == 2 ) {
    buttonA = false;
    yearr++;
    rtc.adjust(DateTime(yearr,monthh,dayy,hourr,minutee,secondd));
  }
  else if (umi == 3 ) {
    buttonA = false;
    monthh++;
    rtc.adjust(DateTime(yearr,monthh,dayy,hourr,minutee,secondd));
  }
  else if (umi == 4 ) {
    buttonA = false;
    dayy++;
    rtc.adjust(DateTime(yearr,monthh,dayy,hourr,minutee,secondd));
  }
  else if (umi == 5 ) {
    buttonA = false;
    hourr++;
    rtc.adjust(DateTime(yearr,monthh,dayy,hourr,minutee,secondd));
  }
  else if (umi == 6 ) {
    buttonA = false;
    minutee++;
    rtc.adjust(DateTime(yearr,monthh,dayy,hourr,minutee,secondd));
  }
  else if (umi == 7 ) {
    buttonA = false;
    rtc.adjust(DateTime(yearr,monthh,dayy,hourr,minutee,0));
  }
  else if (umi == 8 ) {
    buttonA = false;
  if (light)
      {
        light = false;
        lightOff();
        }
      else
      {
        light = true;
        lightOn();
       }
}
       }
   if (buttonB) {
    buttonB = false;
      umi++;
      if (umi == 9 ) {
      umi = 0;
  }
    }
   if (buttonC) {
   if (umi == 1 ) {
    buttonC = false;
    contrast--;
    setContrast();
    }
  else if (umi == 2 ) {
    buttonC = false;
    yearr--;
    rtc.adjust(DateTime(yearr,monthh,dayy,hourr,minutee,secondd));
  }
  else if (umi == 3 ) {
    buttonC = false;
    monthh--;
    rtc.adjust(DateTime(yearr,monthh,dayy,hourr,minutee,secondd));
  }
  else if (umi == 4 ) {
    buttonC = false;
    dayy--;
    rtc.adjust(DateTime(yearr,monthh,dayy,hourr,minutee,secondd));
  }
  else if (umi == 5 ) {
    buttonC = false;
    hourr--;
    rtc.adjust(DateTime(yearr,monthh,dayy,hourr,minutee,secondd));
  }
  else if (umi == 6 ) {
    buttonC = false;
    minutee--;
    rtc.adjust(DateTime(yearr,monthh,dayy,hourr,minutee,secondd));
  }
  else if (umi == 7 ) {
    buttonC = false;
    rtc.adjust(DateTime(yearr,monthh,dayy,hourr,minutee,0));
  }
  else if (umi == 8 ) {
    buttonC = false;
    if (light)
      {
        light = false;
        lightOff();
        }
      else
      {
        light = true;
        lightOn();
       }
       }


}
     digitalDisplay();
}

void digitalDisplay(){
    Temp = dht.readTemperature();
    Humi = dht.readHumidity();
    DateTime now = rtc.now();

    printDigitt(now.year());
    yearr == digitt;
    printDigitt(now.month());
    dayy == digitt;
    printDigitt(now.day());
    monthh == digitt;
    printDigitt(now.hour());
    hourr == digitt;
    printDigitt(now.minute());
    minutee == digitt;
    printDigitt(now.second());
    secondd == digitt;
  // digital clock display of the time
    display.setTextSize(1);
    display.clearDisplay();
    if (umi == 1)
      {
    display.setCursor(5, 0);
    display.print(contrast);
        }
    if (umi == 8)
      {
    display.setCursor(7, 0);
    display.print("*");
        }
    display.setTextColor(BLACK, WHITE);
    display.setCursor(24, 0);
    if (umi == 2)
      {
    display.setTextColor(WHITE, BLACK);
        }
      else
      {
    display.setTextColor(BLACK, WHITE);
       }
    printDigits(now.year());
    display.setTextColor(BLACK, WHITE);
    display.print('/');
    if (umi == 3)
      {
    display.setTextColor(WHITE, BLACK);
        }
      else
      {
    display.setTextColor(BLACK, WHITE);
       }
    printDigits(now.month());
    display.setTextColor(BLACK, WHITE);
    display.print('/');
    if (umi == 4)
      {
    display.setTextColor(WHITE, BLACK);
        }
      else
      {
    display.setTextColor(BLACK, WHITE);
       }
    printDigits(now.day());
    if (umi == 7)
      {
    display.setTextColor(WHITE, BLACK);
        }
      else
      {
    display.setTextColor(BLACK, WHITE);
       }
    display.setCursor(72, 20);
    printDigits(now.second());
    display.setTextSize(2);
    display.setCursor(10, 14);
    if (umi == 5)
      {
    display.setTextColor(WHITE, BLACK);
        }
      else
      {
    display.setTextColor(BLACK, WHITE);
       }
    printDigits(now.hour());
    display.setTextColor(BLACK, WHITE);
    display.print(':');
    if (umi == 6)
      {
    display.setTextColor(WHITE, BLACK);
        }
      else
      {
    display.setTextColor(BLACK, WHITE);
       }
    printDigits(now.minute());
    display.setTextColor(BLACK, WHITE);
    display.setCursor(0, 32);
    display.setTextSize(1);
    display.print("T");
    display.setCursor(6, 32);
    display.setTextSize(2);
    display.print(Temp);
    display.print("c");
    display.setCursor(42, 32);
    display.setTextSize(1);
    display.print("H");
    display.setCursor(48, 32);
    display.setTextSize(2);
    display.print(Humi);
    display.print("%");
    display.display();
}
void printDigits(int digits){
  // utility function for digital clock display: prints preceding colon and leading 0
  if(digits < 10){
    display.print('0');
  display.print(digits);
       }
      else
      {
  display.print(digits);
       }
}



  void buttonAisPressed()
  {
    if (NewStateOfbuttonA != StateOfbuttonA)
  {
    if (NewStateOfbuttonA == 0)
    {
      buttonA=true;
    }
    delay(50);
  }
   StateOfbuttonA = NewStateOfbuttonA;
  }

void buttonBisPressed()
{
  if (NewStateOfbuttonB != StateOfbuttonB)
  {
    if (NewStateOfbuttonB == 0) {
      buttonB=true;
    }
    delay(50);
  }
   StateOfbuttonB = NewStateOfbuttonB;
}

void buttonCisPressed()
{
   if (NewStateOfbuttonC != StateOfbuttonC)
  {
    if (NewStateOfbuttonC == 0) {
      buttonC=true;
    }
    delay(50);
  }
   StateOfbuttonC = NewStateOfbuttonC;
}
void lightOn()
  {
    digitalWrite(8,LOW);
  }

    void lightOff()
  {
    digitalWrite(8,HIGH);
  }

  void setContrast()
  {
    display.setContrast(contrast);
    display.display();
  }
void printDigitt(int digitt){
    digitt == digitt;
       }
